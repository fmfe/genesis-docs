(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{363:function(t,s,a){t.exports=a.p+"assets/img/20200524230624.3cc651fe.jpg"},364:function(t,s,a){t.exports=a.p+"assets/img/20200524232646.42ac2fb6.jpg"},365:function(t,s,a){t.exports=a.p+"assets/img/20200524232818.d25f822b.jpg"},366:function(t,s,a){t.exports=a.p+"assets/img/20200525002108.dacbbb86.jpg"},367:function(t,s){t.exports="data:image/png;base64,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"},384:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"基于-vue-ssr-的微架构在-followme5-0-实践"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#基于-vue-ssr-的微架构在-followme5-0-实践"}},[t._v("#")]),t._v(" 基于 Vue SSR 的微架构在 FOLLOWME5.0 实践")]),t._v(" "),n("p",[t._v("2020年5月22日"),n("a",{attrs:{href:"https://www.followme.com/c/21009745?source=genesis",target:"_blank",rel:"noopener noreferrer"}},[t._v("FOLLOWME5.0"),n("OutboundLink")],1),t._v("的第一个版本终于上线了，这也是公司内部基于 "),n("code",[t._v("Genesis")]),t._v(" 上线的第二个项目。首页是老项目经历了最原始的那种 Vue SSR，后来在年初的时候，迁移到了 Nuxt.js 下，再到现在迁移到了 "),n("code",[t._v("Genesis")]),t._v("，可谓是一波三折。")]),t._v(" "),n("h2",{attrs:{id:"首次实践"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#首次实践"}},[t._v("#")]),t._v(" 首次实践")]),t._v(" "),n("p",[n("img",{attrs:{src:a(363),alt:""}}),t._v("\n在2019年的上半年，我们在和 APP 混合开发的项目中，首次实践了模块化，它拥有了独立的 API、路由、状态和页面，并且是按需进行初始化的，但是它并不是完美的，它是基于路由的微模块，并且状态也是按需注入到全局的状态中的管理")]),t._v(" "),n("h2",{attrs:{id:"无路由微模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#无路由微模块"}},[t._v("#")]),t._v(" 无路由微模块")]),t._v(" "),n("p",[t._v("2019年的8月份，我开始介入到 web 端首页的开发，首先面对的就是基于 Vuex 的状态管理，所有的状态全部注入到全局的状态，交集到一起，随着业务的迭代，已经分不清楚哪些是需要的，哪些是可以被删除的，随着业务规模的膨胀，越来越难以维护。为了保证无入侵性，基于"),n("a",{attrs:{href:"https://www.npmjs.com/package/tms.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Tms.js"),n("OutboundLink")],1),t._v("抽象出来了一个支持微模块的状态库，这时候我们的微模块拥有了独立的 API、状态和页面。\n"),n("img",{attrs:{src:a(364),alt:""}}),t._v(" "),n("img",{attrs:{src:a(365),alt:""}}),t._v("\n我们5.0左导航就被抽离成一个独立运行的微模块，一个微模块由多个组件组合而成，它有自己内部状态管理。")]),t._v(" "),n("h2",{attrs:{id:"大跃进"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#大跃进"}},[t._v("#")]),t._v(" 大跃进")]),t._v(" "),n("p",[t._v("在2019年年底的时候，得知我们要升级5.0的版本，网站也将会大幅度的重构，在基于已有的微模块开发理念下，我们希望能够更近一步，解决一些以往项目架构的弊端。")]),t._v(" "),n("p",[t._v("5.0之前，我们有一个公共的导航栏，不管是 CSR、还是 SSR 的项目都需要它，每次导航栏发生变更之后，都需要重新打包十几个项目发布，这极大的消耗了我们的身心体力，我希望能做到一个页面可以由不同的 SSR 服务聚合而成，通过 API 的形式提供给另外一个服务使用。")]),t._v(" "),n("p",[t._v("这个大胆的想法诞生后，我们深入的研究了一下 Nuxt.js，期望它可以做到我们的需求，经过一番调研后，确认无法满足我的需求后，最终还是选择了造轮子。")]),t._v(" "),n("h2",{attrs:{id:"genesis"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#genesis"}},[t._v("#")]),t._v(" Genesis")]),t._v(" "),n("p",[t._v("参考了一些社区 SSR 框架的实现，基本上都是封装好的框架，灵活性较低，而我们期望它是一个简单的 SSR 库，当成一个工具函数来使用，以便于能够支撑多实例运行。")]),t._v(" "),n("p",[t._v("在这里的理念下， 它没有像 Nuxt.js "),n("code",[t._v("nuxt.config.js")]),t._v(" 这样直接读取一个配置开始运行，给你集成了各种各样的功能，它仅仅一个基础到不能再基础的渲染工具函数")]),t._v(" "),n("div",{staticClass:"language-ts extra-class"},[n("pre",{pre:!0,attrs:{class:"language-ts"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SSR")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@fmfe/genesis-core'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" ssr "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token class-name"}},[n("span",{pre:!0,attrs:{class:"token constant"}},[t._v("SSR")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" renderer "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ssr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("createRenderer")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nrenderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("p",[t._v("当然了，在实际的业务中，我们还需要创建一个 HTTP 服务将我们的内容返回给用户。")]),t._v(" "),n("p",[t._v("如果要做到微服务，并且能被不同的服务之间调用，首先就需要服务的自身具备将渲染结果输出 "),n("code",[t._v("JSON")]),t._v(" 的能力，然后第三方服务读取渲染结果，输出到 HTML 中")]),t._v(" "),n("div",{staticClass:"language-ts extra-class"},[n("pre",{pre:!0,attrs:{class:"language-ts"}},[n("code",[t._v("renderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ssr-json'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("我们巧妙的使用了 Vue 的 "),n("code",[t._v("Renderer")]),t._v(" 选项 "),n("a",{attrs:{href:"https://ssr.vuejs.org/zh/api/#template",target:"_blank",rel:"noopener noreferrer"}},[t._v("template"),n("OutboundLink")],1),t._v("，传入一个函数，执行完成后返回了一个 JSON 的渲染结果")]),t._v(" "),n("div",{staticClass:"language-ts extra-class"},[n("pre",{pre:!0,attrs:{class:"language-ts"}},[n("code",[n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" template"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("async")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    strHtml"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("string")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ctx"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Genesis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RenderContext\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Promise")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Genesis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RenderData"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" html "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" strHtml"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("replace")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token regex"}},[n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")]),n("span",{pre:!0,attrs:{class:"token regex-source language-regex"}},[t._v("^(<[A-z]([A-z]|[0-9])+)")]),n("span",{pre:!0,attrs:{class:"token regex-delimiter"}},[t._v("/")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("$1 ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_createRootNodeAttr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" vueCtx"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" resource "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vueCtx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("getPreloadFiles")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("map")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Genesis"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("RenderContextResource "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                file"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ssr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("publicPath"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),t._v("item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("file"),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                extension"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" item"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("extension\n            "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" data "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("html "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("===")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'\x3c!----\x3e'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token template-string"}},[n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("<div ")]),n("span",{pre:!0,attrs:{class:"token interpolation"}},[n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("${")]),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("_createRootNodeAttr")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token interpolation-punctuation punctuation"}},[t._v("}")])]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("></div>")]),n("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("html "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" html"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("script "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" vueCtx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderScripts")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("style "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" vueCtx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("renderStyles")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resource "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("...")]),t._v("resource"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_subs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("fn"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("Function")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("ctx "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("as")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("_subs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" ctx"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("data"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h2",{attrs:{id:"远程组件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#远程组件"}},[t._v("#")]),t._v(" 远程组件")]),t._v(" "),n("p",[t._v("考虑到不是所有的项目，都需要远程调用，所以远程调用组件，我们是以独立的包提供的。在拿到 SSR JSON 的渲染结果后，远程组件将会帮我们负责嵌入到该服务的页面中去。")]),t._v(" "),n("div",{staticClass:"language-vue extra-class"},[n("pre",{pre:!0,attrs:{class:"language-vue"}},[n("code",[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("remote-view")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":fetch")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("fetch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),n("p",[n("code",[t._v("fetch")]),t._v(" 是一个异步的回调函数，你可以通过使用 axios 库来发送请求将 SSR 渲染的结果返回给 "),n("code",[t._v("remote-view")]),t._v(" 组件。")]),t._v(" "),n("div",{staticClass:"language-ts extra-class"},[n("pre",{pre:!0,attrs:{class:"language-ts"}},[n("code",[t._v("renderer"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" url"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" mode"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ssr-json'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("r"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 编写一个接口， 将 r.data 提供给 remote-view 组件访问")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h2",{attrs:{id:"_5-0的服务拆分"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-0的服务拆分"}},[t._v("#")]),t._v(" 5.0的服务拆分")]),t._v(" "),n("p",[n("img",{attrs:{src:a(366),alt:""}}),t._v("\n根据 UI 的呈现效果，我们将左导航和内容区拆分成不同的服务，其中内容区因为开发团队的不同、业务的不同，又拆分成不同的服务。\n第一个版本我们拆分了左导航的 "),n("code",[t._v("node-ssr-general")]),t._v(" 服务，首页和通知的 "),n("code",[t._v("node-ssr-home")]),t._v(" 服务，以及信号的 "),n("code",[t._v("node-ssr-signal")]),t._v(" 服务，每一个服务都是独立部署、独立开发、由不同的人进行维护，只是最终由 "),n("code",[t._v("node-ssr-general")]),t._v(" 服务进行聚合。")]),t._v(" "),n("p",[t._v("未来我们的产品还将会进一步迭代，越来越多的服务都将会被集成进去这个大应用中。")]),t._v(" "),n("h2",{attrs:{id:"内网域名"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#内网域名"}},[t._v("#")]),t._v(" 内网域名")]),t._v(" "),n("p",[t._v("最初的 SSR 服务，尝试过使用 RPC 和 HTTP 获取接口数据进行渲染，后面经过权衡后，在5.0我们统一采用了在服务器配置 HOST 的方式，配置一个内网的域名，提供给 SSR 服务通过 HTTP 请求来获取数据")]),t._v(" "),n("h2",{attrs:{id:"服务的加载策略"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务的加载策略"}},[t._v("#")]),t._v(" 服务的加载策略")]),t._v(" "),n("p",[t._v("为了首屏可以更快的呈现给用户，所以在服务端远程组件走的是 SSR 的渲染，在客户端路由切换的时候，走 CSR 渲染，所以在"),n("code",[t._v("首页")]),t._v("切换到"),n("code",[t._v("信号")]),t._v("栏目时，会有一些加载过程明显的白屏。")]),t._v(" "),n("p",[t._v("后续可以通过 Service Worker 对所有服务的静态资源和 CSR 渲染时的 HTML 进行预加载，减少加载该服务内容时，出现白屏的几率")]),t._v(" "),n("h2",{attrs:{id:"关于微前端"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#关于微前端"}},[t._v("#")]),t._v(" 关于微前端")]),t._v(" "),n("p",[t._v("从理论上，"),n("code",[t._v("Genesis")]),t._v(" 也可以同时做到 React 的支持，输出同样标准的 JSON 渲染结果、同样标准的应用创建和销毁逻辑。只是目前我们团队都是以 Vue 为主，所以这方面还需要团队有时间才能支持。")]),t._v(" "),n("h2",{attrs:{id:"传送们"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#传送们"}},[t._v("#")]),t._v(" 传送们")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://www.followme.com/signal/?source=genesis",target:"_blank",rel:"noopener noreferrer"}},[n("img",{attrs:{src:a(367),alt:"信号",title:"title"}}),n("OutboundLink")],1)]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.followme.com/c/21009745?source=genesis",target:"_blank",rel:"noopener noreferrer"}},[t._v("FOLLOWME5.0"),n("OutboundLink")],1),t._v(" 新版的策略体验")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/fmfe/genesis",target:"_blank",rel:"noopener noreferrer"}},[t._v("Genesis"),n("OutboundLink")],1),t._v(" Github")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://fmfe.github.io/genesis-docs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Genesis"),n("OutboundLink")],1),t._v(" 文档")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/lzxb/vue2-demo",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue demo"),n("OutboundLink")],1),t._v(" 基于 Genesis + TS + Vuex 实现的 SSR demo")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/fmfe/vue-genesis-micro",target:"_blank",rel:"noopener noreferrer"}},[t._v("微架构demo"),n("OutboundLink")],1),t._v(" 基于 Vue SSR for Genesis 框架的微前端&微服务的例子")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://fmfe.github.io/genesis-docs/blog/followme5.0.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("文章来源地址"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);